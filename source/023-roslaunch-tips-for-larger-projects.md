<div id="interwiki"><span>[Wiki](/Documentation)</span></div>

*   [ROS](/ROS)
*   [Tutorials](/ROS/Tutorials)
*   [Roslaunch tips for larger projects](/action/fullsearch/ROS/Tutorials/Roslaunch%20tips%20for%20larger%20projects?action=fullsearch&context=180&value=linkto%3A%22ROS%2FTutorials%2FRoslaunch+tips+for+larger+projects%22 "Click to do a full-text search for this title")

<div dir="ltr" id="content" lang="en"><span class="anchor" id="top"></span><span class="anchor" id="line-1"></span><span class="anchor" id="line-2"></span><span class="anchor" id="line-3"></span><span class="anchor" id="line-4"></span><span class="anchor" id="line-5"></span><span class="anchor" id="line-6"></span><span class="anchor" id="line-7"></span><span class="anchor" id="line-8"></span><span class="anchor" id="line-9"></span><span class="anchor" id="line-10"></span><span class="anchor" id="line-11"></span><span class="anchor" id="line-12"></span><span class="anchor" id="line-13"></span><span class="anchor" id="line-14"></span><span class="anchor" id="line-15"></span><span class="anchor" id="line-16"></span><span class="anchor" id="line-17"></span><span class="anchor" id="line-18"></span><span class="anchor" id="line-19"></span><span class="anchor" id="line-20"></span><span class="anchor" id="line-21"></span><span class="anchor" id="line-22"></span><span class="anchor" id="line-23"></span><span class="anchor" id="line-24"></span>

<div dir="ltr" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.content" lang="en"><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.top"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-1"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-2"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-3"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-4"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-5"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-6"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-7"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-8"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-9"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-10"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-11"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-12"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-13"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-14"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-15"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-16"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-17"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-18"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-19"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-20"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-21"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-22"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-23"></span>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-1-1"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-2-1"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-3-1"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-4-1"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-5-1"></span>

<div>

<table>

<tbody>

<tr>

<td style="background-color: #bbceee">![(!)](/moin_static197/rostheme/img/idea.png "(!)")It is appreciated that problems/questions regarding this tutorial are asked on [answers.ros.org](http://answers.ros.org). Don't forget to include in your question the link to this page, versions of your OS & ROS, and also add appropriate tags.</td>

</tr>

</tbody>

</table>

</div>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-6-1"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-7-1"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-8-1"></span>

## Roslaunch tips for large projects

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-9-1"></span>**Description:** This tutorial describes some tips for writing [roslaunch](/roslaunch) files for large projects. The focus is on how to structure launch files so they may be reused as much as possible in different situations. We'll use the [2dnav_pr2](/2dnav_pr2) package as a case study.  

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-10-1"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-11-1"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-12-1"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-13-1"></span>**Tutorial Level:** INTERMEDIATE   

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-14-1"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-15-1"></span>**Next Tutorial:** [Roslaunch Nodes in Valgrind or GDB](/roslaunch/Tutorials/Roslaunch%20Nodes%20in%20Valgrind%20or%20GDB)  

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-16-1"></span>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-24"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-25"></span>

<div class="table-of-contents">

Contents

1.  [Introduction](#roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.Introduction)
2.  [Top-level organization](#roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.Top-level_organization)
3.  [Machine tags and Environment Variables](#roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.Machine_tags_and_Environment_Variables)
4.  [Parameters, namespaces, and yaml files](#roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.Parameters.2C_namespaces.2C_and_yaml_files)
5.  [Reusing launch files](#roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.Reusing_launch_files)
6.  [Parameter overrides](#roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.Parameter_overrides)
7.  [Roslaunch arguments](#roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.Roslaunch_arguments)

</div>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-26"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-27"></span>

### Introduction

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-28"></span>

Large applications on a robot typically involve several interconnected [nodes](/Nodes), each of which have many [parameters](/Parameter%20Server). 2d navigation is a good example. The [2dnav_pr2](/2dnav_pr2) application consists of the move_base node itself, localization, ground plane filtering, the base controller, and the map server. Collectively, there are also a few hundred ROS parameters that affect the behavior of these nodes. Finally, there are constraints such as the fact that ground plane filtering should run on the same machine as the tilt laser for efficiency.<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-29"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-30"></span>

A roslaunch file allows us to say all this. Given a running robot, launching the file _2dnav_pr2.launch_ in the _2dnav_pr2_ package will bring up everything required for the robot to navigate. In this tutorial, we'll go over this launch file and the various features used.<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-31"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-32"></span>

We'd also like roslaunch files to be as reusable as possible. In this case, moving between physically identical robots can be done without changing the launch files at all. Even a change such as moving from the robot to a simulator can be done with only a few changes. We'll go over how the launch file is structured to make this possible.<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-33"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-34"></span>

### Top-level organization

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-35"></span>

Here is the top-level launch file (in "<tt class="backtick">rospack find 2dnav_pr2</tt>/move_base/2dnav_pr2.launch").<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-36"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-37"></span>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-38"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-39"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-40"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-41"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-42"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-43"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-44"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-45"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-46"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-47"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-48"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-49"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-50"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-51"></span>

<pre><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-1-2"></span><launch>
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-2-2"></span>  <group name="wg">
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-3-2"></span>    <include file="$(find pr2_alpha)/$(env ROBOT).machine" />
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-4-2"></span>    <include file="$(find 2dnav_pr2)/config/new_amcl_node.xml" />
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-5-2"></span>    <include file="$(find 2dnav_pr2)/config/base_odom_teleop.xml" />
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-6-2"></span>    <include file="$(find 2dnav_pr2)/config/lasers_and_filters.xml" />
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-7-2"></span>    <include file="$(find 2dnav_pr2)/config/map_server.xml" />
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-8-2"></span>    <include file="$(find 2dnav_pr2)/config/ground_plane.xml" />
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-9-2"></span>
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-10-2"></span>    <!-- The navigation stack and associated parameters -->
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-11-2"></span>    <include file="$(find 2dnav_pr2)/move_base/move_base.xml" />
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-12-2"></span>  </group>
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-13-2"></span></launch></pre>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-52"></span>

This file includes a set of other files. Each of these included files contains nodes and parameters (and possibly nested includes) pertaining to one part of the system, such as localization, sensor processing, and path planning.<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-53"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-54"></span>

**Design tip: Top-level launch files should be short, and consist of include's to other files corresponding to subcomponents of the application, and commonly changed ROS parameters.**<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-55"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-56"></span>

This makes it easy to swap out one piece of the system, as we'll see later.<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-57"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-58"></span>

To run this on the PR2 robot requires bringing up a [core](/roscore), then bringing up a robot-specific launch file such as _pre.launch_ in the _pr2_alpha_ package, and then launching _2dnav_pr2.launch_. We could have included a robot launch file here rather than requiring it to be launched separately. That would bring the following tradeoffs:<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-59"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-60"></span>

*   PRO: We'd have to do one fewer "open new terminal, roslaunch" step.<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-61"></span>
*   CON: Launching the robot launch file initiates a calibration phase lasting about a minute long. If the 2dnav_pr2 launch file included the robot launch file, every time we killed the roslaunch (with control-c) and brought it back up, the calibration would happen again.<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-62"></span>
*   CON: Some of the 2d navigation nodes require that the calibration already have finished before they start. Roslaunch intentionally does not provide any control on the order or timing of node start up. The ideal solution would be to make nodes work gracefully by waiting till calibration is done, but pending that, putting things in two launch files allows us to launch the robot, wait until calibration is complete, then launch 2dnav.<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-63"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-64"></span>

There is therefore no universal answer on whether or not to split things into multiple launch files. Here, it has been decided to use two different launch files.<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-65"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-66"></span>

**Design tip: Be aware of the tradeoffs when deciding how many top-level launch files your application requires.**<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-67"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-68"></span>

### Machine tags and Environment Variables

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-69"></span>

We would like control over which nodes run on which machines, for load-balancing and bandwidth management. For example, we'd like the [amcl](/amcl) node to run on the same machine as the base laser. At the same time, for reusability, we don't want to hardcode machine names into roslaunch files. Roslaunch handles this with **machine tags**.<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-70"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-71"></span>

The first include is<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-72"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-73"></span>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-74"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-75"></span>

<pre><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-1-3"></span><include file="$(find pr2_alpha)/$(env ROBOT).machine" /></pre>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-76"></span>

The first thing to note about this file is the use of the _env_ substitution argument to use the value of the environment variable ROBOT. For example, doing<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-77"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-78"></span>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-79"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-80"></span>

<pre><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-1-4"></span>export ROBOT=pre</pre>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-81"></span>

prior to the roslaunch would cause the file _pre.machine_ to be included.<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-82"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-83"></span>

**Design tip: Use the env substitution argument to allow parts of a launch file to depend on environment variables.**<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-84"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-85"></span>

Next, let's look at an example machine file: _pre.machine_ in the _pr2_alpha_ package.<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-86"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-87"></span>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-88"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-89"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-90"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-91"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-92"></span>

<pre><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-1-5"></span><launch>
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-2-3"></span>  <machine name="c1" address="pre1" ros-root="$(env ROS_ROOT)" ros-package-path="$(env ROS_PACKAGE_PATH)" default="true" />
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-3-3"></span>  <machine name="c2" address="pre2" ros-root="$(env ROS_ROOT)" ros-package-path="$(env ROS_PACKAGE_PATH)" />
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-4-3"></span></launch></pre>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-93"></span>

This file sets up a mapping between logical machine names, "c1" and "c2" in this case, and actual host names, such as "pre2". It even allows controlling the user you log in as (assuming you have the appropriate ssh credentials).<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-94"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-95"></span>

Once the mapping has been defined, it can be used when launching nodes. For example, the included file _config/new_amcl_node.xml_ in the _2dnav_pr2_ package contains the line<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-96"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-97"></span>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-98"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-99"></span>

<pre><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-1-6"></span><node pkg="amcl" type="amcl" name="amcl" machine="c1"></pre>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-100"></span>

This causes the _amcl_ node to run on machine with logical name _c1_ (looking at the other launch files, you'll see that most of the laser sensor processing has been put on this machine).<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-101"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-102"></span>

When running on a new robot, say one known as _prf_, we just have to change the ROBOT environment variable. The corresponding machine file (_prf.machine_ in the _pr2_alpha_ package) will then be loaded. We can even use this for running on a simulator, by setting ROBOT to _sim_. Looking at the file _sim.machine_ in the _pr2_alpha_ package, we see that it just maps all logical machine names to localhost.<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-103"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-104"></span>

**Design tip: Use machine tags to balance load and control which nodes run on the same machine, and consider having the machine file name depend on an environment variable for reusability.**<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-105"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-106"></span>

### Parameters, namespaces, and yaml files

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-107"></span>

Let's look at the included file _move_base.xml_. Here is a portion of this file:<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-108"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-109"></span>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-110"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-111"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-112"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-113"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-114"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-115"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-116"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-117"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-118"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-119"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-120"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-121"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-122"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-123"></span>

<pre><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-1-7"></span><node pkg="move_base" type="move_base" name="move_base" machine="c2">
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-2-4"></span>  <remap from="odom" to="pr2_base_odometry/odom" />
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-3-4"></span>  <param name="controller_frequency" value="10.0" />
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-4-4"></span>  <param name="footprint_padding" value="0.015" />
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-5-3"></span>  <param name="controller_patience" value="15.0" />
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-6-3"></span>  <param name="clearing_radius" value="0.59" />
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-7-3"></span>  <rosparam file="$(find 2dnav_pr2)/config/costmap_common_params.yaml" command="load" ns="global_costmap" />
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-8-3"></span>  <rosparam file="$(find 2dnav_pr2)/config/costmap_common_params.yaml" command="load" ns="local_costmap" />
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-9-3"></span>  <rosparam file="$(find 2dnav_pr2)/move_base/local_costmap_params.yaml" command="load" />
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-10-3"></span>  <rosparam file="$(find 2dnav_pr2)/move_base/global_costmap_params.yaml" command="load" />
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-11-3"></span>  <rosparam file="$(find 2dnav_pr2)/move_base/navfn_params.yaml" command="load" />
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-12-3"></span>  <rosparam file="$(find 2dnav_pr2)/move_base/base_local_planner_params.yaml" command="load" />
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-13-3"></span></node></pre>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-124"></span>

This fragment launches the _move_base_ node. The first included element is a **remapping**. Move_base is designed to receive odometry on the topic "odom". In the case of the pr2, odometry is published on the _pr2_base_odometry_ topic, so we remap it.<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-125"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-126"></span>

**Design tip: Use topic remapping when a given type of information is published on different topics in different situations.**<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-127"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-128"></span>

This is followed by a bunch of <param> tags. Note that these parameters are inside the node element (since they're before the </node> at the end), so they will be [private parameters](/Parameter%20Server#Private_Parameters). For example, the first one sets _move_base/controller_frequency_ to 10.0\.<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-129"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-130"></span>

After the <param> elements, there are some <rosparam> elements. These read parameter data in yaml, a format which is human readable and allows complex data structures. Here's a portion of the _costmap_common_params.yaml_ file loaded by the first <rosparam> element:<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-131"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-132"></span>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-133"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-134"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-135"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-136"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-137"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-138"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-139"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-140"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-141"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-142"></span>

<pre><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-1-8"></span>raytrace_range: 3.0
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-2-5"></span>footprint: [[-0.325, -0.325], [-0.325, 0.325], [0.325, 0.325], [0.46, 0.0], [0.325, -0.325]]
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-3-5"></span>inflation_radius: 0.55
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-4-5"></span>
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-5-4"></span># BEGIN VOXEL STUFF
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-6-4"></span>observation_sources: base_scan_marking base_scan tilt_scan ground_object_cloud
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-7-4"></span>
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-8-4"></span>base_scan_marking: {sensor_frame: base_laser, topic: /base_scan_marking, data_type: PointCloud, expected_update_rate: 0.2,
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-9-4"></span>  observation_persistence: 0.0, marking: true, clearing: false, min_obstacle_height: 0.08, max_obstacle_height: 2.0}</pre>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-143"></span>

We see that yaml allows things like vectors (for the _footprint_ parameter). It also allows putting some parameters into a nested [namespace](/Names). For example, _base_scan_marking/sensor_frame_ is set to _base_laser_. Note that these namespaces are relative to the yaml file's own namespace, which was declared as _global_costmap_ by the _ns_ attribute of the including _rosparam_ element. In turn, since that _rosparam_ was included by the node element, the fully qualified name of the parameter is _/move_base/global_costmap/base_scan_marking/sensor_frame_.<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-144"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-145"></span>

The next line in move_base.xml is:<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-146"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-147"></span>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-148"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-149"></span>

<pre><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-1-9"></span><rosparam file="$(find 2dnav_pr2)/config/costmap_common_params.yaml" command="load" ns="local_costmap" /></pre>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-150"></span>

This actually includes the exact same yaml file as the line before it. It's just in a different namespace (the local_costmap namespace is for the trajectory controller, while the global_costmap namespace affects the global navigation planner). This is much nicer than having to retype all the values.<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-151"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-152"></span>

The next line is:<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-153"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-154"></span>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-155"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-156"></span>

<pre><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-1-10"></span><rosparam file="$(find 2dnav_pr2)/move_base/local_costmap_params.yaml" command="load"/></pre>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-157"></span>

Unlike the previous ones, this element doesn't have an _ns_ attribute. Thus the yaml file's namespace is the parent namespace, _/move_base_. But take a look at the first few lines of the yaml file itself:<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-158"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-159"></span>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-160"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-161"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-162"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-163"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-164"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-165"></span>

<pre><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-1-11"></span>local_costmap:
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-2-6"></span>  #Independent settings for the local costmap
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-3-6"></span>  publish_voxel_map: true
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-4-6"></span>  global_frame: odom_combined
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-5-5"></span>  robot_base_frame: base_link</pre>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-166"></span>

Thus we see that the parameters are in the _/move_base/local_costmap_ namespace after all.<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-167"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-168"></span>

**Design tip: Yaml files allow parameters with complex types, nested namespaces of parameters, and reusing the same parameter values in multiple places.**<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-169"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-170"></span>

### Reusing launch files

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-171"></span>

The motivation for many of the tips above was to make reusing launch files in different situations easier. We've already seen one example, where the use of the _env_ substitution arg can allow modifying behavior without changing any launch files. There are some situations, though, where that's inconvenient or impossible. Let's take a look at the [pr2_2dnav_gazebo](/pr2_2dnav_gazebo) package. This contains a version of the 2d navigation app, but for use in the [Gazebo simulator](/simulator_gazebo). For navigation, the only thing that changes is actually that the Gazebo environment we use is based on a different static map, so the map_server node must be loaded with a different argument. We could have used another env substitution here. But that would require the user to set a bunch of environment variables just to be able to roslaunch. Instead, 2dnav gazebo contains its own top level launch file called '2dnav-stack-amcl.launch', shown here (modified slightly for clarity):<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-172"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-173"></span>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-174"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-175"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-176"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-177"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-178"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-179"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-180"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-181"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-182"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-183"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-184"></span>

<pre><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-1-12"></span><launch>
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-2-7"></span>  <include file="$(find pr2_alpha)/sim.machine" />
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-3-7"></span>  <include file="$(find 2dnav_pr2)/config/new_amcl_node.xml" />
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-4-7"></span>  <include file="$(find 2dnav_pr2)/config/base_odom_teleop.xml" />
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-5-6"></span>  <include file="$(find 2dnav_pr2)/config/lasers_and_filters.xml" />
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-6-5"></span>  <node name="map_server" pkg="map_server" type="map_server" args="$(find gazebo_worlds)/Media/materials/textures/map3.png 0.1" respawn="true" machine="c1" />
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-7-5"></span>  <include file="$(find 2dnav_pr2)/config/ground_plane.xml" />
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-8-5"></span>  <!-- The naviagtion stack and associated parameters -->
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-9-5"></span>  <include file="$(find 2dnav_pr2)/move_base/move_base.xml" />
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-10-4"></span></launch></pre>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-185"></span>

The first difference is that, since we know we're on the simulator, we just use the sim.machine file rather than using a substitution argument. Second, the line<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-186"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-187"></span>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-188"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-189"></span>

<pre><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-1-13"></span><include file="$(find 2dnav_pr2)/config/map_server.xml" /></pre>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-190"></span>

has been replaced by<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-191"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-192"></span>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-193"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-194"></span>

<pre><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-1-14"></span><node name="map_server" pkg="map_server" type="map_server" args="$(find gazebo_worlds)/Media/materials/textures/map3.png 0.1" respawn="true" machine="c1" /></pre>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-195"></span>

The included file in the first case just contained a node declaration as in the second case, but with a different map file.<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-196"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-197"></span>

**Design tip: To modify a "top-level" aspect of an application, copy the top level launch file and change the portions you need.**<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-198"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-199"></span>

### Parameter overrides

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-200"></span>

The technique above sometimes becomes inconvenient. Suppose we want to use _2dnav_pr2_, but just change the resolution parameter of the local costmap to 0.5\. We could just locally change _local_costmap_params.yaml_. This is the simplest for temporary modifications, but it means we can't check the modified file back in. We could instead make a copy of _local_costmap_params.yaml_ and modify it. We would then have to change _move_base.xml_ to include the modified yaml file. And then we would have to change _2dnav_pr2.launch_ to include the modified _move_base.xml_. This can be time-consuming, and if using version control, we would no longer see changes to the original files. An alternative is to restructure the launch files so that the _move_base/local_costmap/resolution_ parameter is defined in the top-level file _2dnav_pr2.launch_, and make a modified version of just that file. This is a good option if we know in advance which parameters are likely to be changed.<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-201"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-202"></span>

Another option is to use roslaunch's overriding behavior: parameters are set in order (after includes are processed). Thus, we could make a further top-level file that overrides the original resolution:<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-203"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-204"></span>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-205"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-206"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-207"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-208"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-209"></span>

<pre><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-1-15"></span><launch>
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-2-8"></span><include file="$(find 2dnav_pr2)/move_base/2dnav_pr2.launch" />
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-3-8"></span><param name="move_base/local_costmap/resolution" value="0.5"/>
<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-4-8"></span></launch></pre>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-210"></span>

The main drawback is that this method can make things harder to understand: knowing the actual value that roslaunch sets for a parameter requires tracing through the including roslaunch files. But it does avoid having to make copies of multiple files.<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-211"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-212"></span>

**Design tip: To modify a deeply nested parameter in a tree of launch files which you cannot change, use roslaunch's parameter overriding semantics.**<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-213"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-214"></span>

### Roslaunch arguments

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-215"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-216"></span>

As of CTurtle, roslaunch has an argument substitution feature together with tags that allow conditioning parts of the launch file on the value of arguments. This can be a more general and clear way to structure things than the parameter override mechanism or launch file reuse techniques above, at the cost of having to modify the original launch file to specify what the changeable arguments are. See the [roslaunch XML documentation](/roslaunch/XML).<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-217"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-218"></span>

**Design tip: If you can modify the original launch file, it's often preferable to use roslaunch arguments rather than parameter overriding or copying roslaunch files.**<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-219"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-220"></span>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-221"></span>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-222"></span>

<span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.line-223"></span><span class="anchor" id="roslaunch.2BAC8-Tutorials.2BAC8-Roslaunch_tips_for_larger_projects.bottom"></span>

</div>

<span class="anchor" id="line-25"></span><span class="anchor" id="line-26"></span><span class="anchor" id="bottom"></span></div>

Wiki: ROS/Tutorials/Roslaunch tips for larger projects (last edited 2012-11-16 19:06:20 by <span title="William J. Woodall @ gw.willowgarage.com[70.35.54.194]">[WilliamWoodall](/WilliamWoodall "William J. Woodall @ gw.willowgarage.com[70.35.54.194]")</span>)
